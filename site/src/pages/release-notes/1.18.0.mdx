---
date: 2022-08-04
---

## üåü New features

- Users can extract the innermost wrapped object conveniently #4338
- Users can decorate a service using a builder method like the following
```java
GrpcService.builder()
           .addService(myGrpcService1Impl, List.of(LoggingService.newDecorator()))
           .addService(myGrpcService2Impl, List.of(LoggingService.newDecorator(), MetricCollectingService.newDecorator()))             
           .addService(myGrpcService3Impl, List.of(delegate -> delegate.decorate(new CustomDecorator())
           .build();
``` #4311 #4316
- Support Markdown Description  #4304
- Support Enums&Return Types documentation in annotated service #4304
- You can have a richer error model as described by [google error model](https://cloud.google.com/apis/design/errors#error_model) 
eg.   #4231
-  #4231
- if you throw exceptions like 
 ```
           final ErrorInfo errorInfo = ErrorInfo.newBuilder()
                                                 .setDomain("test")
                                                 .setReason("Unknown Exception").build();
            final com.google.rpc.Status
                    status = com.google.rpc.Status.newBuilder()
                                                  .setCode(
                                                          Code.UNKNOWN.getNumber())
                                                  .setMessage("Unknown Exceptions Test")
                                                  .addDetails(
                                                          Any.pack(errorInfo))
                                                  .build();
            responseObserver.onError(StatusProto.toStatusRuntimeException(status));
```
You can use this error handler by doing
``` 
sb.service(GrpcService.builder()   
                              .addService(grpcService)   
                              .unframedGrpcErrorHandler(UnframedGrpcErrorHandler.ofRichJson())   
                              .build());
```
You can get a response 
```
{
	"error": {
		"code": 500,
		"status": "UNKNOWN",
		"message": "Unknown Exceptions Test",
		"details": [{
			"@type": "type.googleapis.com/google.rpc.ErrorInfo",
			"reason": "Unknown Exception",
			"domain": "test"
		}]
	}
}
``` #4231
- Support file upload for GraphQL #3971 #4199

## üìà Improvements

- Developers may add more utility functions to `RequestContext` without worrying about public API exposure #4308
- Armeria tries to unwrap `RequestContext` instead of simply checking the type. #4308
- Add AnnotatedServiceConfigSetters, Replace Interface #4205 #4210

## üõ†Ô∏è Bug fixes

- `ClosedSessionException` and `ClosedStreamException` are raised correctly according to its usage. #4380
- You no longer see `IllegalStateException` when a gRPC service run on a
  blocking take executor. #4367 #4374
- Fix file serving from OSGI bundle classloader #4371 #4373
- `requestStartTimeNanos` and `requestStartTimeMicros` are now correctly
  recoded when `RequestHeaders` is received. #4365 #4372
- You no longer see a false positive warning for unknown `MethodType` when using gRPC clients. #4363
- You no longer see a `NoSuchElementException` while an `HealthEndpointGroup` is closing. #4349
- Please Recommend a Test file to put it in (or a name for a new test file)~~ Integration tests added #4337 #4348

## üèöÔ∏è Deprecations

- N/A

## ‚ò¢Ô∏è Breaking changes

- N/A

## ‚õì Dependencies



## üóë Maybe ignore

- no warnings! #4368
- Migrate `dependencies.yml` to Gradle's version catalogs #4120 #4353
- Set okhttp version explicitly in `retrofit2` module #4345 #4346
- Developers may add more utility functions to `RequestContext` without worrying about public API exposure #4308
- Armeria tries to unwrap `RequestContext` instead of simply checking the type. #4308

## üôá Thank you

<ThankYou usernames={[
  'CLAassistant',
  'anuraaga',
  'cnabro',
  'heowc',
  'ikhoon',
  'j-min5u',
  'jrhee17',
  'mauhiz',
  'minwoox',
  'natsumehu',
  'ngyukman',
  'proceane',
  'ta7uw',
  'trustin'
]} />