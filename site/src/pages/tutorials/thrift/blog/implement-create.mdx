---
menuTitle: "Implement CREATE"
order: 4
category: thrift
tags:
  - server
level: basic
type: step
---

# Implementing CREATE operation

In the previous step, we defined empty service methods.
In this step, we'll fill in one of the service methods to create a blog post and again, try making a call to a service method.

<TutorialSteps current={4} />

## What you need

You need to have the following obtained from previous steps:

- [Java code generated](/tutorials/thrift/blog/create-server#compile-the-thrift-file) for each server and client
- `Main.java` for server
- `BlogServiceImpl.java` for server
- `BlogClient.java` for client

## 1. Implement server-side

Let's implement the `createBlogPost()` method in the `BlogServiceImpl` class.

1. Create an ID generator to issue temporary blog post IDs and a map to contain blog posts.
  ```java filename=BlogServiceImpl.java
  import java.util.Map;
  import java.util.concurrent.ConcurrentHashMap;
  import java.util.concurrent.atomic.AtomicInteger;

  public class BlogServiceImpl implements BlogService.AsyncIface {
      private final AtomicInteger idGenerator = new AtomicInteger();
      private final Map<Integer, BlogPost> blogPosts = new ConcurrentHashMap<>();
      ...
  }
  ```
2. In the `createBlogPost()` method, create a `BlogPost` object with request parameters.
  ```java filename=BlogServiceImpl.java
  import java.time.Instant;

  public class BlogServiceImpl implements BlogService.AsyncIface {
      ...
      @Override
      public void createBlogPost(CreateBlogPostRequest request, AsyncMethodCallback<BlogPost> resultHandler)
              throws TException {
          final int id = idGenerator.getAndIncrement();
          final Instant now = Instant.now();
          final BlogPost blogPost = new BlogPost()
                  .setId(id)
                  .setTitle(request.getTitle())
                  .setContent(request.getContent())
                  .setModifiedAt(now.toEpochMilli())
                  .setCreatedAt(now.toEpochMilli());
      }
  }
  ```
2. In the `createBlogPost()` method, save the post information in the `blogPosts` map and return the information of the blog post created to the `resultHandler`.
  ```java filename=BlogServiceImpl.java
  @Override
  public void createBlogPost(CreateBlogPostRequest request, AsyncMethodCallback<BlogPost> resultHandler)
          throws TException {
      ...
      blogPosts.put(id, blogPost);
      final BlogPost stored = blogPost;
      resultHandler.onComplete(stored);
  }
  ```

## 2. Implement client-side

Add a method `createBlogPost()` in the `BlogClient` class to send a request to create a blog post.

```java filename=BlogClient.java
import example.armeria.blog.thrift.BlogPost;
import example.armeria.blog.thrift.CreateBlogPostRequest;

public class BlogClient {
  ...
  void createBlogPost(String title, String content) throws Exception {
    final CreateBlogPostRequest request =
        new CreateBlogPostRequest().setTitle(title)
                                .setContent(content);
    final BlogPost response = blogService.createBlogPost(request);
    logger.info("[Create response] Title: {} Content: {}",
                    response.getTitle(), response.getContent());
  }
}
```

## 3. Test creating a blog post

Now, to test what we implemented so far in this step, let's make a request to the server for creating a blog post.
Note the code is minimal to keep things simple.

1. Add a method, `testRun()`, to test the creation method we just implemented.
  ```java filename=BlogClient.java
  void testRun() throws Exception {
      createBlogPost("My first blog", "Yay");
  }
  ```
2. In the `main()` method, call the `testRun()` method.
  ```java filename=BlogClient.java
  public static void main(String[] args) throws Exception {
      ...
      BlogClient blogClient = new BlogClient();
      blogClient.testRun();
  }
  ```
2. [Re-run the server](/tutorials/thrift/blog/create-server#7-test-run).
  Your server is running if you see the following message.
  ```bash
  [armeria-boss-http-*:8080] INFO com.linecorp.armeria.server.Server - Serving HTTP at /[0:0:0:0:0:0:0:0]:8080 - http://127.0.0.1:8080/
  ```
3. Run the client's `main()` method on your IDE or using Gradle.
  Your client made request to the server successfully if you see the following message.
  ```bash
  [main] INFO example.armeria.client.blog.thrift.BlogClient - [Create response] Title: My first blog Content: Yay
  ```

## What's next

In this step, we've implemented a method for creating a blog post.

Next, at [Step 5. Implement READ](/tutorials/thrift/blog/implement-read), we'll implement a READ operation to read a single post and also multiple posts.

<TutorialSteps current={4} />
